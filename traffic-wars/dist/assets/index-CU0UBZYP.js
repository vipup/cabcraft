import{u as e,i as t,w as i,j as s,L as n,a as r,b as a,c as o,G as l}from"./game-ffSH2Oc6.js";import{a as d,r as c,R as h}from"./vendor-BXk_ma1u.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const i of e)if("childList"===i.type)for(const e of i.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var u={},m=d;u.createRoot=m.createRoot,u.hydrateRoot=m.hydrateRoot;let x=1,p=1,g=1;const v=()=>{const{worldSize:s,camera:n,drivers:r,riders:a,addDriver:o,addRider:l,addRideRequest:d,updateDriver:h,updateRider:u,removeDriver:m,removeRider:v,removeRideRequest:f,cleanMap:y,setBuildings:j,setRoads:w,setStreetNames:M,setLandmarks:b}=e(),R=c.useCallback(()=>{const e=window.innerWidth-56-300,t=window.innerHeight-48-32,i=Math.max(100,e),r=Math.max(100,t),a=i/n.zoom/2,o=r/n.zoom/2,l=Math.max(a,Math.min(s.width-a,n.x)),d=Math.max(o,Math.min(s.height-o,n.y));return{minX:Math.max(0,l-a),maxX:Math.min(s.width,l+a),minY:Math.max(0,d-o),maxY:Math.min(s.height,d+o)}},[n,s]);return{initializeGame:c.useCallback(()=>{t("üöó Initializing Traffic Simulator...");const e=[];for(let t=0;t<14;t++)e.push({x:0,y:84+100*t,width:s.width,height:32});for(let t=0;t<16;t++)e.push({x:100+140*t,y:0,width:32,height:s.height});w(e);const i=[];for(let t=0;t<13;t++)for(let e=0;e<15;e++){const s=132+140*e,n=116+100*t,r=Math.floor(3*Math.random())+1;for(let e=0;e<r;e++){const e=40+40*Math.random(),t=30+30*Math.random(),r=Math.random()*(70-e),a=Math.random()*(36-t);i.push({x:s+r,y:n+a,width:e,height:t})}}j(i);const n=[];["Main St","Broadway","Oak Ave","Pine St","Elm St","Maple Ave","Cedar St","First St","Second St","Third St","Fourth St","Fifth St","Park Ave","Central St"].forEach((e,t)=>{const i=84+100*t+16;n.push({name:e,x:s.width/2,y:i})}),["First Ave","Second Ave","Third Ave","Fourth Ave","Fifth Ave","Central Ave","North Ave","South Ave","East Ave","West Ave","Grand Ave","Union Ave","Liberty Ave","Washington Ave","Lincoln Ave","Jefferson Ave"].forEach((e,t)=>{const i=100+140*t+16;n.push({name:e,x:i,y:s.height/2})}),M(n);b([{name:"Downtown",icon:"üè¢",x:600,y:400},{name:"Airport",icon:"‚úàÔ∏è",x:1800,y:800},{name:"Mall",icon:"üõçÔ∏è",x:1200,y:1200},{name:"Station",icon:"üöâ",x:400,y:1e3},{name:"Hospital",icon:"üè•",x:2e3,y:400},{name:"University",icon:"üéì",x:800,y:1400}]),t("‚úÖ Traffic Simulator initialized!")},[s,j,w,M,b]),spawnRider:c.useCallback(()=>{const e=R(),i=Math.random()*(e.maxX-e.minX-100)+e.minX+50,s=Math.random()*(e.maxY-e.minY-100)+e.minY+50,n={id:p++,x:i,y:s,status:"idle"};l(n),t(`üë§ Spawned rider #${n.id} at (${Math.round(i)}, ${Math.round(s)}) in viewport`)},[R,l]),spawnDriver:c.useCallback((e=null)=>{const i=R(),s=Math.random()*(i.maxX-i.minX-100)+i.minX+50,n=Math.random()*(i.maxY-i.minY-100)+i.minY+50,r=e||(Math.random()<.5?"ground":"air"),a={id:x++,x:s,y:n,type:r,status:"idle",speed:"air"===r?200:120};o(a);t(`${"air"===r?"‚úàÔ∏è":"üöó"} Spawned ${r} ${"air"===r?"pilot":"driver"} #${a.id} at (${Math.round(s)}, ${Math.round(n)}) in viewport`)},[R,o]),createRideRequest:c.useCallback((e=null)=>{const s=a.filter(e=>"idle"===e.status);if(0===s.length)return void i("‚ö†Ô∏è No idle riders available!");const n=s[Math.floor(Math.random()*s.length)],o=e||(Math.random()<.6?"ground":"air"),l=n.x,c=n.y,m=R(),x=Math.random()*(m.maxX-m.minX-100)+m.minX+50,p=Math.random()*(m.maxY-m.minY-100)+m.minY+50,v=Math.sqrt(Math.pow(x-l,2)+Math.pow(p-c,2)),f="air"===o?.15:.1,y=Math.round(v*f)||10,j={id:g++,riderId:n.id,type:o,pickupX:l,pickupY:c,dropoffX:x,dropoffY:p,fare:y,distance:v,pricePerKm:f,assignedDriver:null,status:"waiting_for_pickup",createdAt:Date.now()};u(n.id,{status:"waiting"});const w=r.filter(e=>"idle"===e.status&&e.type===o);if(w.length>0){let e=null,i=1/0;if(w.forEach(t=>{const s=Math.sqrt(Math.pow(t.x-l,2)+Math.pow(t.y-c,2));s<i&&(i=s,e=t)}),e){j.assignedDriver=e,j.status="going_to_rider",h(e.id,{status:"going_to_rider",targetX:l,targetY:c});t(`${"air"===o?"‚úàÔ∏è":"üöó"} ${"air"===o?"Pilot":"Driver"} #${e.id} assigned to ${o} ride #${j.id}`)}}d(j);const M="air"===o?"‚úàÔ∏è":"üöó";t(`üì± Created ${o} ride request #${j.id}: $${y} ${M}`)},[R,d,a,r,u,h]),cleanMap:c.useCallback(()=>{y(),x=1,p=1,g=1,t("üßπ Map cleaned!")},[y])}},f=()=>{const{isAutonomousMode:i,autoSimulationConfig:s,drivers:n,riders:r,rideRequests:a,simulationSpeed:o}=e(),{spawnRider:l,spawnDriver:d,createRideRequest:h}=v(),u=c.useRef({spawnRiders:null,spawnDrivers:null,createRides:null}),m=c.useCallback(()=>{Object.values(u.current).forEach(e=>{e&&clearInterval(e)}),u.current={spawnRiders:null,spawnDrivers:null,createRides:null}},[]),x=c.useCallback(()=>{i&&(t("ü§ñ Starting autonomous simulation..."),m(),u.current.spawnRiders=setInterval(()=>{r.length<s.maxRiders&&l()},s.spawnRidersInterval/o),u.current.spawnDrivers=setInterval(()=>{n.length<s.maxDrivers&&d()},s.spawnDriversInterval/o),u.current.createRides=setInterval(()=>{a.filter(e=>"waiting_for_pickup"===e.status||"going_to_rider"===e.status||"in_progress"===e.status).length<s.maxActiveRides&&r.length>0&&h()},s.createRidesInterval/o),t(`‚úÖ Autonomous simulation started with intervals: ${s.spawnRidersInterval}ms riders, ${s.spawnDriversInterval}ms drivers, ${s.createRidesInterval}ms rides`))},[i,s,n.length,r.length,a,o,l,d,h,m]),p=c.useCallback(()=>{m(),t("üõë Autonomous simulation stopped")},[m]);return c.useEffect(()=>(i?x():p(),()=>{m()}),[i,x,p,m]),c.useEffect(()=>{i&&x()},[o,i,x]),c.useEffect(()=>{i&&x()},[s,i,x]),{startAutonomousSimulation:x,stopAutonomousSimulation:p,clearAllIntervals:m}},y=()=>{const{earnings:t,rating:i,activeRides:a,ridesPanelHidden:o,setRidesPanelHidden:l,selectedUnit:d,simulationSpeed:c,setSimulationSpeed:h,logLevel:u,setLogLevel:m,isAutonomousMode:x,setIsAutonomousMode:p,autoSimulationConfig:g,setAutoSimulationConfig:v,drivers:y,riders:j,rideRequests:w}=e();f();const M=(e,t)=>{v(i=>({...i,[e]:parseInt(t)}))};return s.jsxs("div",{className:"top-banner",children:[s.jsx("div",{className:"banner-title",children:"üöó Traffic Simulator"}),s.jsxs("div",{className:"banner-achievements",children:["$",t," ‚Ä¢ ‚≠ê",i.toFixed(1)," ‚Ä¢ Active ",a," ‚Ä¢ üöó",y.length," ‚Ä¢ üèçÔ∏è",j.length," ‚Ä¢ üì±",w.length]}),s.jsxs("div",{className:"banner-speed-control",children:[s.jsxs("label",{htmlFor:"speed-slider",children:["Speed: ",c.toFixed(2),"x"]}),s.jsx("input",{id:"speed-slider",type:"range",min:"0.25",max:"4",step:"0.25",value:c,onChange:e=>{h(parseFloat(e.target.value))},className:"speed-slider"})]}),s.jsxs("div",{className:"banner-actions",children:[s.jsxs("button",{className:"unit-button autonomous-btn "+(x?"active":""),onClick:()=>{p(!x)},title:x?"Stop autonomous simulation":"Start autonomous simulation",children:["ü§ñ ",x?"Auto ON":"Auto OFF"]}),s.jsxs("button",{className:"unit-button toggle-rides-btn",onClick:()=>l(!o),children:["üìã ",o?"Show":"Hide"," Rides"]}),s.jsxs("div",{className:"log-level-selector",children:[s.jsx("label",{htmlFor:"log-level-select",children:"Log Level:"}),s.jsxs("select",{id:"log-level-select",value:u,onChange:e=>{m(parseInt(e.target.value))},className:"log-level-select",style:{color:n[u]},children:[s.jsx("option",{value:r.DEBUG,style:{color:n[r.DEBUG]},children:"DEBUG"}),s.jsx("option",{value:r.INFO,style:{color:n[r.INFO]},children:"INFO"}),s.jsx("option",{value:r.WARNING,style:{color:n[r.WARNING]},children:"WARNING"}),s.jsx("option",{value:r.ERROR,style:{color:n[r.ERROR]},children:"ERROR"})]})]}),x&&s.jsxs("div",{className:"autonomous-config",children:[s.jsxs("div",{className:"config-item",children:[s.jsx("label",{children:"Riders:"}),s.jsx("input",{type:"number",min:"1",max:"50",value:g.maxRiders,onChange:e=>M("maxRiders",e.target.value),className:"config-input"})]}),s.jsxs("div",{className:"config-item",children:[s.jsx("label",{children:"Drivers:"}),s.jsx("input",{type:"number",min:"1",max:"30",value:g.maxDrivers,onChange:e=>M("maxDrivers",e.target.value),className:"config-input"})]}),s.jsxs("div",{className:"config-item",children:[s.jsx("label",{children:"Rides:"}),s.jsx("input",{type:"number",min:"1",max:"20",value:g.maxActiveRides,onChange:e=>M("maxActiveRides",e.target.value),className:"config-input"})]})]})]})]})},j=()=>{const{spawnRider:e,spawnDriver:t,createRideRequest:i,cleanMap:n}=v();return s.jsxs("div",{className:"left-toolbar",children:[s.jsx("button",{className:"unit-button toolbar-btn",onClick:e,title:"Spawn Rider",children:"üë§"}),s.jsx("button",{className:"unit-button toolbar-btn",onClick:()=>t("ground"),title:"Spawn Ground Driver (Car)",children:"üöó"}),s.jsx("button",{className:"unit-button toolbar-btn",onClick:()=>t("air"),title:"Spawn Air Driver (Pilot)",children:"‚úàÔ∏è"}),s.jsx("button",{className:"unit-button toolbar-btn",onClick:()=>i("ground"),title:"Request Ground Ride (Car)",children:"üöóüì±"}),s.jsx("button",{className:"unit-button toolbar-btn",onClick:()=>i("air"),title:"Request Air Ride (Flying)",children:"‚úàÔ∏èüì±"}),s.jsx("button",{className:"unit-button toolbar-btn clean-btn",onClick:n,title:"Clean Map",children:"üßπ"})]})},w=()=>{const{camera:t,worldSize:i}=e(),s=c.useMemo(()=>{const e=window.innerWidth-56-300,s=window.innerHeight-48-32,n=Math.max(100,e),r=Math.max(100,s),a=n/t.zoom/2,o=r/t.zoom/2,l=Math.max(a,Math.min(i.width-a,t.x)),d=Math.max(o,Math.min(i.height-o,t.y)),c=100;return{minX:Math.max(0,l-a-c),maxX:Math.min(i.width,l+a+c),minY:Math.max(0,d-o-c),maxY:Math.min(i.height,d+o+c)}},[t,i]),n=c.useMemo(()=>(e,t,i=0,n=0)=>e+i>=s.minX&&e<=s.maxX&&t+n>=s.minY&&t<=s.maxY,[s]),r=c.useMemo(()=>(e,t=e=>({x:e.x,y:e.y,width:e.width||0,height:e.height||0}))=>e.filter(e=>{const i=t(e);return n(i.x,i.y,i.width,i.height)}),[n]);return{viewportBounds:s,isInViewport:n,filterByViewport:r}},M=()=>{const{roads:t,buildings:i,streetNames:n,landmarks:r}=e(),{filterByViewport:a}=w(),o=a(i),l=a(n,e=>({x:e.x-50,y:e.y-10,width:100,height:20}));return s.jsxs("g",{className:"city-background",children:[t.map((e,t)=>s.jsx("rect",{x:e.x,y:e.y,width:e.width,height:e.height,fill:"#4a5a6a"},`road-${t}`)),o.map((e,t)=>s.jsx("rect",{x:e.x,y:e.y,width:e.width,height:e.height,fill:"#8f9ca3",stroke:"#6d7d8e",strokeWidth:"2"},`building-${e.x}-${e.y}`)),l.map((e,t)=>s.jsx("text",{x:e.x,y:e.y,fill:"white",fontSize:"12",fontWeight:"bold",textAnchor:"middle",style:{pointerEvents:"none"},children:e.name},`street-${e.x}-${e.y}`)),r.map((e,t)=>s.jsxs("g",{children:[s.jsx("text",{x:e.x,y:e.y,fill:"yellow",fontSize:"20",textAnchor:"middle",children:e.icon}),s.jsx("text",{x:e.x,y:e.y+20,fill:"white",fontSize:"12",textAnchor:"middle",fontWeight:"bold",children:e.name})]},`landmark-${t}`))]})},b=()=>{const{drivers:t,riders:i,rideRequests:n}=e(),{filterByViewport:r}=w(),a=r(t,e=>({x:e.x-12,y:e.y-12,width:24,height:24})),o=r(i,e=>({x:e.x-9,y:e.y-9,width:18,height:18}));return s.jsxs("g",{className:"game-entities",children:[n.map(e=>{if(!e.assignedDriver)return null;const i=t.find(t=>t.id===e.assignedDriver.id);if(!i)return null;const n="going_to_rider"===i.status?"#3498db":"#2ecc71";if("ground"===i.type&&i.path&&i.path.length>0){const t=[];if(i.pathIndex<i.path.length){const r=i.path[i.pathIndex];t.push(s.jsx("line",{x1:i.x,y1:i.y,x2:r.x,y2:r.y,stroke:n,strokeWidth:"3",strokeDasharray:"10,5",opacity:"0.6"},`path-${e.id}-start`))}for(let r=i.pathIndex;r<i.path.length-1;r++){const a=i.path[r],o=i.path[r+1];t.push(s.jsx("line",{x1:a.x,y1:a.y,x2:o.x,y2:o.y,stroke:n,strokeWidth:"3",strokeDasharray:"10,5",opacity:"0.6"},`path-${e.id}-${r}`))}return s.jsx("g",{children:t},`path-group-${e.id}`)}{const t="going_to_rider"===i.status?e.pickupX:e.dropoffX,r="going_to_rider"===i.status?e.pickupY:e.dropoffY;return s.jsx("line",{x1:i.x,y1:i.y,x2:t,y2:r,stroke:n,strokeWidth:"3",strokeDasharray:"10,5",opacity:"0.6"},`path-${e.id}`)}}),n.map(e=>{const t="air"===e.type?"‚úàÔ∏è":"üöó",i="air"===e.type?"#9b59b6":"#f1c40f",n="air"===e.type?"#8e44ad":"#e67e22";return s.jsxs("g",{children:[s.jsx("circle",{cx:e.pickupX,cy:e.pickupY,r:"12",fill:i,stroke:n,strokeWidth:"2",opacity:"0.8"}),s.jsxs("text",{x:e.pickupX,y:e.pickupY+20,fill:"white",fontSize:"10",textAnchor:"middle",fontWeight:"bold",children:[t," $",e.fare]}),s.jsx("circle",{cx:e.dropoffX,cy:e.dropoffY,r:"10",fill:"#2ecc71",stroke:"#27ae60",strokeWidth:"2",opacity:"0.6"})]},`ride-${e.id}`)}),o.map(e=>s.jsxs("g",{children:[s.jsx("circle",{cx:e.x,cy:e.y,r:"9",fill:"#2ecc71",stroke:"#27ae60",strokeWidth:"2"}),s.jsx("text",{x:e.x,y:e.y+4,fill:"white",fontSize:"12",textAnchor:"middle",children:"üë§"})]},`rider-${e.id}`)),a.map(e=>{const t="air"===e.type,i=t?"‚úàÔ∏è":"üöó",n=t?"#9b59b6":"#3498db",r=t?"#8e44ad":"#2980b9";return s.jsxs("g",{children:[s.jsx("rect",{x:e.x-12,y:e.y-12,width:"24",height:"24",fill:n,stroke:r,strokeWidth:"2",rx:"4"}),s.jsx("text",{x:e.x,y:e.y+5,fill:"white",fontSize:"14",textAnchor:"middle",children:i})]},`driver-${e.id}`)})]})},R=()=>{const t=c.useRef(null),{worldSize:i,camera:n,updateCamera:r,selectedRideId:o,setSelectedRideId:l,rideRequests:d,drivers:u}=e(),{isMobile:m}=a(),[x,p]=h.useState(!1),[g,v]=h.useState({x:0,y:0}),[f,y]=h.useState(0),j=c.useRef(null),w=()=>{p(!1)},R=e=>{e.preventDefault();const t=e.deltaY>0?.9:1.1,i=Math.max(.5,Math.min(3,n.zoom*t));r({zoom:i})},k=e=>{if(e.preventDefault(),1===e.touches.length)o&&l(null),p(!0),v({x:e.touches[0].clientX,y:e.touches[0].clientY});else if(2===e.touches.length){const t=e.touches[0],i=e.touches[1],s=Math.sqrt(Math.pow(i.clientX-t.clientX,2)+Math.pow(i.clientY-t.clientY,2));y(s),p(!1)}},N=e=>{if(e.preventDefault(),2===e.touches.length){const t=e.touches[0],i=e.touches[1],s=Math.sqrt(Math.pow(i.clientX-t.clientX,2)+Math.pow(i.clientY-t.clientY,2));if(f>0){const e=s/f,t=Math.max(.5,Math.min(3,n.zoom*e));r({zoom:t})}return void y(s)}if(!x||1!==e.touches.length)return;const t=e.touches[0],s=(t.clientX-g.x)/n.zoom,a=(t.clientY-g.y)/n.zoom,o=m?0:300,l=(window.innerWidth-56-o)/(2*n.zoom),d=(window.innerHeight-48-32)/(2*n.zoom);r({x:Math.max(l,Math.min(i.width-l,n.x-s)),y:Math.max(d,Math.min(i.height-d,n.y-a))}),v({x:t.clientX,y:t.clientY})},S=e=>{e.preventDefault(),p(!1),y(0)};c.useEffect(()=>{const e=t.current;if(e)return e.addEventListener("wheel",R,{passive:!1}),e.addEventListener("touchstart",k,{passive:!1}),e.addEventListener("touchmove",N,{passive:!1}),e.addEventListener("touchend",S,{passive:!1}),()=>{e.removeEventListener("wheel",R),e.removeEventListener("touchstart",k),e.removeEventListener("touchmove",N),e.removeEventListener("touchend",S)}},[n.zoom,m]),c.useEffect(()=>{if(!o)return void(j.current&&(clearInterval(j.current),j.current=null));const e=()=>{const e=d.find(e=>e.id===o);if(!e||!e.assignedDriver)return;const t=u.find(t=>t.id===e.assignedDriver.id);if(!t)return;const s=(window.innerWidth-56-300)/(2*n.zoom),a=(window.innerHeight-48-32)/(2*n.zoom),l=Math.max(s,Math.min(i.width-s,t.x)),c=Math.max(a,Math.min(i.height-a,t.y));r({x:l,y:c})};return e(),j.current=setInterval(e,16),()=>{j.current&&(clearInterval(j.current),j.current=null)}},[o,d,u,r]);const A=m?0:300,D=window.innerWidth-56-A,$=window.innerHeight-48-32,C=Math.max(100,D),z=Math.max(100,$),I=C/(2*n.zoom),Y=z/(2*n.zoom),X=Math.max(I,Math.min(i.width-I,n.x)),E=Math.max(Y,Math.min(i.height-Y,n.y)),W=Math.max(0,X-I),L=Math.max(0,E-Y),F=Math.max(1,C/n.zoom),q=Math.max(1,z/n.zoom);return s.jsxs("svg",{ref:t,className:"game-svg "+(x?"dragging":""),viewBox:`${W} ${L} ${F} ${q}`,onMouseDown:e=>{o&&l(null),p(!0),v({x:e.clientX,y:e.clientY})},onMouseMove:e=>{if(!x)return;const t=(e.clientX-g.x)/n.zoom,s=(e.clientY-g.y)/n.zoom,a=m?0:300,o=(window.innerWidth-56-a)/(2*n.zoom),l=(window.innerHeight-48-32)/(2*n.zoom);r({x:Math.max(o,Math.min(i.width-o,n.x-t)),y:Math.max(l,Math.min(i.height-l,n.y-s))}),v({x:e.clientX,y:e.clientY})},onMouseUp:w,onMouseLeave:w,children:[s.jsx(M,{}),s.jsx(b,{})]})},k=()=>{const{gameTime:t,drivers:i,riders:n,camera:r,earnings:a,rating:o,activeRides:l,completedRides:d,totalDriverDistance:c}=e(),h=i.length+n.length,u=i.filter(e=>"ground"===e.type).length,m=i.filter(e=>"air"===e.type).length,x=d.length>0?Math.round(d.reduce((e,t)=>e+t.duration,0)/d.length):0,p=i.length>0?Math.round(c/i.length/1e3*10)/10:0;return s.jsxs("div",{className:"bottom-stats-bar",children:[s.jsxs("div",{className:"stat-item",children:["Time: ",(g=t,`${Math.floor(g/60)}:${(g%60).toString().padStart(2,"0")}`)]}),s.jsxs("div",{className:"stat-item",children:["Agents: ",h," (üöó ",u," ‚Ä¢ ‚úàÔ∏è ",m," ‚Ä¢ üë§ ",n.length,")"]}),s.jsxs("div",{className:"stat-item",children:["Avg Ride: ",x,"s"]}),s.jsxs("div",{className:"stat-item",children:["Avg Driver Dist: ",p,"km"]}),s.jsxs("div",{className:"stat-item",children:["Zoom: ",r.zoom.toFixed(1),"x"]}),s.jsxs("div",{className:"stat-item",children:["Camera: ",Math.round(r.x),", ",Math.round(r.y)]}),s.jsxs("div",{className:"stat-item main-stats",children:["üí∞ ",a," ‚Ä¢ ‚≠ê ",o.toFixed(1)," ‚Ä¢ üöó Active ",l]})]});var g},N=()=>{const{rideRequests:t,ridesFilter:i,ridesSort:n,selectedRideId:r,setRidesFilter:a,setRidesSort:o,setSelectedRideId:l}=e(),d=(e,t)=>{a({...i,status:{...i.status,[e]:t}})},c=e=>{o({field:e,ascending:n.field!==e||!n.ascending})};let h=t.filter(e=>{const t=!i.search||e.id.toString().includes(i.search)||e.fare.toString().includes(i.search),s=e.assignedDriver&&"on_ride"===e.assignedDriver.status?"inProgress":"waiting",n=i.status[s];return t&&n});return h.sort((e,t)=>{const i=e[n.field]||0,s=t[n.field]||0;return n.ascending?i-s:s-i}),s.jsxs("div",{className:"active-rides-panel",children:[s.jsx("h3",{children:"Active Rides"}),s.jsxs("div",{className:"rides-controls",children:[s.jsxs("div",{className:"search-controls",children:[s.jsx("label",{children:"Search:"}),s.jsx("input",{type:"text",placeholder:"ID, fare, status...",value:i.search,onChange:e=>{a({...i,search:e.target.value.toLowerCase()})}})]}),s.jsxs("div",{className:"filter-controls",children:[s.jsx("label",{children:"Status:"}),s.jsxs("div",{className:"status-bullets",children:[s.jsxs("label",{className:"status-bullet-label",children:[s.jsx("input",{type:"checkbox",checked:i.status.waiting,onChange:e=>d("waiting",e.target.checked)}),s.jsx("span",{className:"status-bullet waiting",children:"‚è≥"})]}),s.jsxs("label",{className:"status-bullet-label",children:[s.jsx("input",{type:"checkbox",checked:i.status.inProgress,onChange:e=>d("inProgress",e.target.checked)}),s.jsx("span",{className:"status-bullet in-progress",children:"üöó"})]}),s.jsxs("label",{className:"status-bullet-label",children:[s.jsx("input",{type:"checkbox",checked:i.status.completed,onChange:e=>d("completed",e.target.checked)}),s.jsx("span",{className:"status-bullet completed",children:"‚úÖ"})]})]})]}),s.jsxs("div",{className:"quick-stats",children:[s.jsxs("span",{className:"stat-item",children:["Total: ",t.length]}),s.jsxs("span",{className:"stat-item",children:["Filtered: ",h.length]})]})]}),s.jsx("div",{className:"table-container",children:s.jsxs("table",{className:"rides-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{onClick:()=>c("id"),children:"ID"}),s.jsx("th",{onClick:()=>c("type"),children:"Type"}),s.jsx("th",{onClick:()=>c("status"),children:"Status"}),s.jsx("th",{onClick:()=>c("fare"),children:"Fare"}),s.jsx("th",{children:"Pickup"}),s.jsx("th",{children:"Dropoff"})]})}),s.jsx("tbody",{children:0===h.length?s.jsx("tr",{children:s.jsx("td",{colSpan:"6",children:"No active rides"})}):h.map(e=>{const t="air"===e.type?"‚úàÔ∏è":"üöó",i=r===e.id;return s.jsxs("tr",{className:i?"selected-row":"",onClick:()=>l(i?null:e.id),children:[s.jsxs("td",{children:["#",e.id]}),s.jsx("td",{children:t}),s.jsx("td",{children:s.jsx("span",{className:"status-badge "+(e.assignedDriver?"in-progress":"waiting"),children:e.assignedDriver?"üöó":"‚è≥"})}),s.jsxs("td",{children:["$",e.fare]}),s.jsxs("td",{children:[Math.round(e.pickupX),",",Math.round(e.pickupY)]}),s.jsxs("td",{children:[Math.round(e.dropoffX),",",Math.round(e.dropoffY)]})]},e.id)})})]})})]})},S=()=>{const{ridesPanelHidden:t}=e(),{initializeGame:i}=v();return o(),f(),c.useEffect(()=>{i()},[i]),s.jsxs("div",{className:"game-container",children:[s.jsx(y,{}),s.jsx(j,{}),s.jsx(R,{}),s.jsx(k,{}),!t&&s.jsx(N,{})]})};function A(){return s.jsx(l,{children:s.jsx(S,{})})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("üì± Traffic Simulator: Service Worker registered successfully",e.scope)}).catch(e=>{console.log("‚ùå Traffic Simulator: Service Worker registration failed",e)})}),u.createRoot(document.getElementById("root")).render(s.jsx(h.StrictMode,{children:s.jsx(A,{})}));
